<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>D-File</title>
    <script src="https://cdn.bootcdn.net/ajax/libs/axios/1.1.3/axios.min.js"></script>
    <script src="https://unpkg.com/js-base64"></script>
    <link rel="shortcut icon" type="image/x-icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAMxJREFUOE+t06FuAkEQxvH/FxpegUoeovXUoOobJLapRDaw2T1b21qwoNGUB8BW45jwDmQJENIj3F2vd0wyZjL7m2QmK2qGar7nCLSGsadIF2hfgOLTvGZFQ47A/Xt0iFFG45jI5Kp+x9acfg71v4Dc4YKHTdDqDHSAQ2ZFzKkvLdH3LyDegGYqixcsvHkt0sDiXxcRz+Y1rw7AiwVN6wB9CxpXB8SreX1VByIDS/RRBxhaonACXGyzYwo8lrzEmgZP5rS+zWcqOTWzbQ96PEURUT++WAAAAABJRU5ErkJggg==" />
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { padding: 20px 0 10px; background: #000; color: #fff; }
        body { font-size: 16px; max-width: 80%; margin: 0 auto; }
        h2 { margin-bottom: 10px; }
        .back { display: inline-block; border: 1px solid #ff9000; padding: 4px 12px; font-size: 15px; font-weight: normal; cursor: pointer; margin-left: 20px; margin-top: 0; background: #ff9000; color: #000; border-radius: 3px; transition: all 0.2s; }
        .back:hover { background: #000; color: #ff9000; }
        input.back { cursor: auto; background: #1b1b1b; border: 1px solid #333; color: #fff; }
        .ftr { float: right; }
        .file_list li { line-height: 40px; border-bottom: 1px solid #333; display: flex; align-items: center; padding: 6px 0; }
        li { list-style-type: none; }
        /* Additional styles omitted for brevity */
    </style>
</head>
<body>
    <div id="drop-zone" style="min-height: calc(100vh - 200px); position: relative;" ondrop="handleDrop(event)" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)">
        <div class="drag-hint"> ğŸ’¡ æ”¯æŒæ‹–æ‹½ä¸Šä¼ ï¼šç›´æ¥å°†æ–‡ä»¶æ‹–æ”¾åˆ°é¡µé¢ä»»æ„ä½ç½®å³å¯ä¸Šä¼  </div>
        <p style="margin: 0">ç‰ˆæœ¬å·: 20250101-1 <span class="tip">æµ‹è¯•å»¶è¿Ÿè¯·åœ¨æ ¹ç›®å½•ä¸Šä¼ <b>init.jpg</b>(50kbä»¥å†…)</span></p>
        <h4>æ ¹åŸŸå:<input type="text" value="" id="rootdm" /></h4>
        <input type="file" id="file" class="filepond" name="filepond" />
        <h2>å½“å‰ç›®å½•ï¼š<i id="repo"></i><span onclick="addDir()" class="back">æ–°å»ºç›®å½•</span><span onclick="document.getElementById('file').click()" class="back">ä¸Šä¼ æ–‡ä»¶</span><span onclick="dirBack()" class="back">â†è¿”å›</span><span onclick="refresh()" class="back ftr">åˆ·æ–°</span></h2>
        <div id="file_wrap">
            <ul class="file_list" id="file_list">åŠ è½½ä¸­...</ul>
        </div>
        <div id="loading" class="hide">å¤„ç†ä¸­...</div>
    </div>

    <script>
        window.baseRepo = localStorage.getItem("GIT_REPO") || "dhjz/file";
        window.baseToken = localStorage.getItem("GIT_TOKEN") || "";
        
        if (!baseToken) alert("è¯·å…ˆè®¾ç½®ä»“åº“å’Œtoken");

        function toggleWrap() {
            var wrap = document.getElementById("file_wrap");
            wrap.className = wrap.className ? "" : "w50";
        }

        // å¢åŠ ç¦æ­¢åˆ é™¤æƒé™çš„é€»è¾‘
        const deletePermission = false;

        function deleteFile(fileName) {
            if (!deletePermission) {
                alert("æ‚¨æ²¡æœ‰æƒé™åˆ é™¤æ­¤æ–‡ä»¶ã€‚");
                return;
            }
            // åˆ é™¤æ–‡ä»¶çš„é€»è¾‘
            console.log(`Deleting file ${fileName}`);
            // å®é™…åˆ é™¤ä»£ç ...
        }

        // æ–‡ä»¶åˆ—è¡¨æ¸²æŸ“å‡½æ•°
        function renderFileList(files) {
            const fileList = document.getElementById("file_list");
            fileList.innerHTML = ""; // æ¸…ç©ºå½“å‰æ–‡ä»¶åˆ—è¡¨
            files.forEach(file => {
                const li = document.createElement("li");
                li.textContent = file.name;
                li.onclick = () => deleteFile(file.name); // ç‚¹å‡»æ–‡ä»¶æ—¶å°è¯•åˆ é™¤
                fileList.appendChild(li);
            });
        }

        document.getElementById("file").addEventListener("input", (e) => {
            const file = e.target.files[0];
            if (file) putFile(paths.length ? paths[paths.length - 1] + "/" + file.name : file.name, file);
            document.getElementById("file").value = "";
        });

        function updateRepo() {
            const val = prompt("è¯·è¾“å…¥ä»“åº“ {owner}/{repo}", localStorage.getItem("GIT_REPO") || "dhjz/file");
            if (val) localStorage.setItem("GIT_REPO", val) || location.reload();
        }

        function updateToken() {
            const val = prompt("è¯·è¾“å…¥token", localStorage.getItem("GIT_TOKEN") || "");
            if (val) localStorage.setItem("GIT_TOKEN", val) || location.reload();
        }

        // Additional functions omitted for brevity
    </script>
</body>
</html>
